# 调试悬浮窗测试指南

## 测试前准备

1. **确保权限已开启**
   - 悬浮窗权限: 设置 → 应用 → 你的应用 → 显示在其他应用的上层
   - 无障碍服务: 设置 → 无障碍 → 你的应用

2. **启动应用**
   - 打开应用
   - 确保无障碍服务已启动（会显示Toast提示）

## 测试步骤

### 1. 开启调试悬浮窗
1. 在应用主界面，点击底部导航栏的"设置"
2. 滚动到页面底部，找到"调试功能"区域
3. 点击"显示/隐藏调试悬浮窗"按钮
4. 应该看到屏幕底部出现一个半透明的黑色调试悬浮窗（高度为屏幕的1/3，置顶显示）

### 2. 验证调试信息显示
调试悬浮窗应该显示以下信息：

#### 基础信息
- ⏰ 当前时间 (实时更新)
- 📡 无障碍事件类型 (显示最后接收到的事件类型)
- ⏱️ 事件触发时间 (显示最后接收到事件的时间)
- 📱 当前APP信息 (如果正在使用支持的APP)

#### 悬浮窗状态
- 🪟 主悬浮窗: 显示/隐藏
- 🔧 调试悬浮窗: 显示

#### 系统信息
- 💾 内存使用情况

### 3. 测试实时更新
1. 保持调试悬浮窗显示
2. 切换到其他应用（如微信、小红书等）
3. 观察调试悬浮窗中的信息是否实时更新
4. 时间应该每2秒更新一次

### 4. 测试控制功能
1. **刷新按钮测试**
   - 点击调试悬浮窗中的"刷新"按钮
   - 应该看到Toast提示"调试信息已刷新"
   - 调试信息应该立即更新

2. **隐藏按钮测试**
   - 点击调试悬浮窗中的"隐藏"按钮
   - 应该看到Toast提示"调试悬浮窗已隐藏"
   - 调试悬浮窗应该消失

### 5. 测试切换功能
1. 在设置页面再次点击"显示/隐藏调试悬浮窗"按钮
2. 如果调试悬浮窗已显示，应该隐藏
3. 如果调试悬浮窗已隐藏，应该显示

## 测试场景

### 场景1: 无活跃APP
- 当前没有使用支持的APP时
- 调试信息中"当前APP"应显示"无"

### 场景2: 有活跃APP
- 使用微信、小红书等支持的APP时
- 调试信息应显示APP名称、包名、目标词等信息

### 场景3: 主悬浮窗显示
- 当主悬浮窗显示时
- 调试信息中"主悬浮窗"应显示"显示"

### 场景4: 内存监控
- 观察内存使用情况
- 应该显示已用、可用、总计、最大内存信息

## 预期结果

### 正常情况
- ✅ 调试悬浮窗能正常显示和隐藏
- ✅ 调试信息每2秒自动更新
- ✅ 刷新按钮能手动更新信息
- ✅ 隐藏按钮能关闭调试悬浮窗
- ✅ 设置页面的切换按钮能正常工作
- ✅ 调试信息准确反映当前状态

### 异常情况处理
- ❌ 如果调试悬浮窗不显示，检查悬浮窗权限
- ❌ 如果调试信息不更新，检查无障碍服务
- ❌ 如果按钮无响应，重启应用后重试

## 故障排除

### 问题1: 调试悬浮窗不显示
**可能原因**: 悬浮窗权限未开启
**解决方法**: 
1. 进入系统设置
2. 找到应用管理
3. 找到你的应用
4. 开启"显示在其他应用的上层"权限

### 问题2: 调试信息不更新
**可能原因**: 无障碍服务未启动
**解决方法**:
1. 进入系统设置
2. 找到无障碍设置
3. 找到你的应用并开启

### 问题3: 按钮无响应
**可能原因**: 应用崩溃或服务异常
**解决方法**:
1. 重启应用
2. 重新开启无障碍服务
3. 重新测试

## 性能测试

### 内存使用
- 观察调试悬浮窗对内存使用的影响
- 正常情况下影响应该很小

### 电池消耗
- 长时间运行调试悬浮窗
- 观察电池消耗是否明显增加

### 系统稳定性
- 长时间运行应用
- 确保调试悬浮窗不会导致系统卡顿

## 测试完成标准

✅ 调试悬浮窗能正常显示和隐藏
✅ 调试信息能实时更新
✅ 控制按钮功能正常
✅ 在不同APP间切换时信息正确
✅ 长时间运行稳定
✅ 性能影响在可接受范围内

## 测试报告模板

```
测试日期: _________
测试人员: _________
测试结果: [通过/失败]

详细结果:
1. 调试悬浮窗显示: [正常/异常]
2. 调试信息更新: [正常/异常]
3. 控制按钮功能: [正常/异常]
4. 多APP切换: [正常/异常]
5. 长时间运行: [正常/异常]

问题记录:
_________________________________
_________________________________

建议:
_________________________________
_________________________________
``` 